Оглавление
Введение	2
Актуальность задачи детектирования и мониторинга БПЛА	2
Цели и задачи работы	2
Научная новизна и практическая значимость	3
Глава 1. Обзор существующих методов и технологий	4
Методы визуального детектирования БПЛА	4
Технологии измерения расстояния до объектов	6
Алгоритмы трекинга объектов	8
Существующие системы мониторинга БПЛА	9
Выводы по главе	11
Глава 2. Теоретические основы детектирования объектов	12
Методы машинного обучения для детектирования объектов	12
Сверточные нейронные сети в задачах детектирования	13
Архитектуры современных детекторов	14
Метрики оценки качества детектирования	16
Выводы по главе	17
Глава 3. Теоретические основы стереозрения	18
Калибровка камеры	18
Расчёт расстояния до объекта	20
Пошаговый алгоритм вычисления расстояния	21
Синхронизация камер	22
Выводы по главе	22

 
Введение
Актуальность задачи детектирования и мониторинга БПЛА
Стремительное распространение беспилотных летательных аппаратов (БПЛА) в различных сферах деятельности привело к существенному повышению интереса к технологиям их обнаружения и отслеживания. В современном мире БПЛА активно применяются в таких областях, как экологический мониторинг, сельское хозяйство, кинематография, логистика и доставка грузов, что обусловливает их растущее присутствие в воздушном пространстве. По мере развития технологий беспилотных аппаратов возникают значительные проблемы, связанные с безопасностью воздушного движения, защитой частной жизни граждан и предотвращением несанкционированного использования БПЛА в запрещенных зонах, включая критически важные объекты инфраструктуры, правительственные учреждения и места массового скопления людей.
Традиционные системы обнаружения воздушных объектов, такие как радары, зачастую оказываются недостаточно эффективными при работе с малоразмерными БПЛА, особенно изготовленными из композитных материалов с низкой радиолокационной заметностью. Кроме того, существующие системы часто не обеспечивают необходимого уровня точности при определении класса БПЛА и прогнозировании его траектории движения, что критически важно для принятия своевременных мер реагирования. Данные обстоятельства обусловливают необходимость разработки инновационных подходов к обнаружению и мониторингу беспилотных летательных аппаратов.
Визуальное детектирование БПЛА, основанное на применении компьютерного зрения и методов глубокого обучения, представляет собой перспективное направление, способное эффективно решать задачи идентификации, классификации и отслеживания беспилотных аппаратов в реальном времени. Современные алгоритмы машинного обучения, в частности, сверточные нейронные сети, демонстрируют значительный потенциал в данной области, обеспечивая высокую точность обнаружения даже в сложных условиях наблюдения. Интеграция этих методов с алгоритмами трекинга объектов открывает возможности для создания комплексных систем мониторинга, способных непрерывно отслеживать перемещения БПЛА в динамически изменяющейся среде.
Цели и задачи работы
Основной целью данной работы является разработка и исследование системы визуального детектирования и мониторинга БПЛА, обеспечивающей высокую точность обнаружения и отслеживания беспилотных летательных аппаратов в режиме реального времени. 
Для достижения поставленной цели необходимо решить следующие задачи:
	Проведение анализа существующих методов визуального детектирования объектов и определение наиболее эффективных подходов для обнаружения БПЛА в различных условиях наблюдения. Особое внимание уделяется современным архитектурам сверточных нейронных сетей, таким как YOLO, SSD и Faster R-CNN, с точки зрения их применимости к задаче детектирования малоразмерных быстродвижущихся объектов.
	Исследование технологий измерения расстояния до объектов, включая методы стереозрения, структурированного света и времяпролетные камеры, с целью определения оптимального подхода для оценки пространственного положения БПЛА в трехмерном пространстве.
	Изучение современных алгоритмов трекинга объектов, включая SORT, DeepSORT и ByteTrack, и оценка их эффективности для непрерывного отслеживания траекторий движения БПЛА даже в условиях временных окклюзий.
	Сбор и подготовка разнообразного набора данных, содержащего изображения БПЛА различных типов и размеров в разнообразных условиях наблюдения, для обучения и тестирования моделей детектирования.
	Разработка архитектуры системы визуального детектирования и мониторинга БПЛА, интегрирующей модули обнаружения, трекинга и расчета расстояния в единый программно-аппаратный комплекс с возможностью обработки видеопотока в режиме реального времени.
	Экспериментальная оценка разработанной системы с использованием стандартных метрик качества, включая точность (precision), полноту (recall) и среднюю точность (mAP), для определения эффективности предложенного решения в различных сценариях применения.
Научная новизна и практическая значимость
Научная новизна исследования заключается в разработке интегрированного подхода к визуальному детектированию и мониторингу БПЛА, объединяющего в себе преимущества современных методов глубокого обучения для обнаружения объектов и алгоритмов трекинга для непрерывного отслеживания их перемещений. В рамках исследования предложены оригинальные модификации архитектуры YOLOv8, адаптированные для эффективного обнаружения малоразмерных быстродвижущихся объектов, характерных для задачи детектирования БПЛА. Разработанные улучшения включают оптимизацию функции потерь, совершенствование структуры сети и динамический выбор якорных рамок, что позволяет существенно повысить точность обнаружения при сохранении высокой скорости обработки.
Кроме того, научную новизну представляет предложенный подход к интеграции алгоритма SORT с системой детектирования на основе YOLOv8, обеспечивающий создание обратной связи между модулями отслеживания и обнаружения. Данная методика позволяет использовать информацию о траекториях движения БПЛА для корректировки параметров детектирования, что приводит к более стабильной работе системы в целом и снижению частоты переключения идентификаторов при отслеживании объектов.
Практическая значимость исследования определяется широким спектром потенциальных применений разработанной системы визуального детектирования и мониторинга БПЛА. В первую очередь, данная система может быть использована для обеспечения безопасности критически важных объектов инфраструктуры, включая атомные электростанции, нефтеперерабатывающие заводы, правительственные учреждения и военные объекты, путем своевременного обнаружения несанкционированных БПЛА в их воздушном пространстве.
Другой важной областью применения является обеспечение безопасности массовых мероприятий, таких как спортивные соревнования, концерты и политические собрания, где несанкционированное использование БПЛА может представлять угрозу для участников. Кроме того, разработанная система может быть интегрирована в системы управления воздушным движением для обеспечения безопасного совместного использования воздушного пространства пилотируемыми и беспилотными летательными аппаратами.
Предложенное решение также имеет значительный коммерческий потенциал в качестве самостоятельного продукта для обеспечения безопасности частной собственности и защиты конфиденциальности, а также может быть использовано как компонент более сложных систем безопасности и наблюдения. Оптимизированная архитектура модели детектирования позволяет развертывать систему на устройствах с ограниченными вычислительными ресурсами, что расширяет возможности ее практического применения.
Глава 1. Обзор существующих методов и технологий
Методы визуального детектирования БПЛА
Визуальное детектирование БПЛА представляет собой сложную задачу компьютерного зрения, требующую обнаружения и классификации малоразмерных быстродвижущихся объектов в условиях изменяющегося фона и освещения. Современные методы визуального детектирования БПЛА можно разделить на две основные категории: традиционные алгоритмы, основанные на выделении характерных признаков изображения, и подходы на основе глубокого обучения, в частности, сверточных нейронных сетей (CNN).
Традиционные методы визуального детектирования включают в себя алгоритмы выделения движущихся объектов на основе вычитания фона, методы на основе оптического потока и подходы, использующие заранее определенные визуальные признаки. Методы вычитания фона основаны на построении модели статического фона и выделении отклонений от этой модели, что позволяет обнаруживать движущиеся объекты, включая БПЛА. Данные методы отличаются низкими вычислительными требованиями, однако демонстрируют недостаточную эффективность в условиях изменяющегося фона и освещения, а также при наличии других движущихся объектов в кадре.
Методы на основе оптического потока анализируют направление и скорость движения пикселей между последовательными кадрами видеопотока, что позволяет выявлять характерные паттерны движения, свойственные БПЛА. Данный подход обеспечивает более высокую точность по сравнению с методами вычитания фона, особенно при наличии сложного фона, однако требует значительных вычислительных ресурсов и часто оказывается недостаточно эффективным при детектировании малоразмерных объектов на большом расстоянии.
Подходы, использующие заранее определенные визуальные признаки, такие как гистограммы ориентированных градиентов (HOG) и признаки Хаара, в сочетании с классификаторами, такими как метод опорных векторов (SVM) или AdaBoost, применялись для детектирования БПЛА на начальных этапах развития данной области. Однако, данные методы имеют ограниченную способность к обобщению и адаптации к различным условиям наблюдения, что существенно ограничивает их практическое применение.
Современные методы визуального детектирования БПЛА базируются преимущественно на глубоком обучении, в частности, на использовании сверточных нейронных сетей (CNN), которые показали значительное преимущество по сравнению с традиционными подходами. Сверточные нейронные сети способны автоматически извлекать иерархические признаки из изображений, начиная от низкоуровневых деталей, таких как края и текстуры, и заканчивая высокоуровневыми семантическими концепциями.
Архитектуры детекторов объектов на основе CNN, применяемые для обнаружения БПЛА, можно разделить на двухэтапные и одноэтапные. Двухэтапные детекторы, такие как Faster R-CNN, сначала генерируют предложения регионов, потенциально содержащих объекты, а затем классифицируют эти регионы и уточняют координаты ограничивающих рамок. Данные архитектуры обеспечивают высокую точность детектирования, однако имеют относительно низкую скорость обработки, что ограничивает их применение в системах реального времени.
Одноэтапные детекторы, такие как YOLO и SSD, выполняют обнаружение и классификацию объектов за один проход через нейронную сеть, что существенно повышает скорость обработки. YOLO (You Only Look Once) представляет собой семейство архитектур, которые обрабатывают изображение как единое целое, разделяя его на сетку ячеек и предсказывая ограничивающие рамки и вероятности классов для каждой ячейки. Последние версии YOLO, в частности YOLOv8, демонстрируют значительные улучшения в точности детектирования малоразмерных объектов за счет оптимизации архитектуры сети, функции потерь и процесса обучения.
SSD (Single Shot Detector) использует многомасштабные карты признаков для обнаружения объектов различных размеров, что особенно важно для задачи детектирования БПЛА, которые могут иметь различные размеры на изображении в зависимости от расстояния до камеры. Данная архитектура обеспечивает хороший баланс между скоростью и точностью, что делает ее подходящей для систем реального времени.
Экспериментальные исследования показывают, что архитектуры YOLOv8 и SSD являются наиболее перспективными для задачи визуального детектирования БПЛА благодаря их способности обрабатывать изображения в режиме реального времени при сохранении высокой точности детектирования. В частности, YOLOv8 демонстрирует улучшенную производительность в обнаружении малоразмерных объектов, что критически важно для данной задачи.
Технологии измерения расстояния до объектов
Определение пространственного положения БПЛА в трехмерном пространстве является важной задачей для систем мониторинга, требующей применения специализированных технологий измерения расстояния до объектов. Современные подходы к измерению расстояния можно классифицировать по принципу работы на пассивные и активные методы.
Пассивные методы измерения расстояния основаны на анализе оптической информации без излучения дополнительных сигналов. Ключевым представителем данной категории является стереозрение, которое использует две или более камеры, расположенные на известном расстоянии друг от друга, для получения изображений сцены с различных ракурсов. Путем нахождения соответствующих точек на изображениях и вычисления диспаратности (смещения) между ними можно определить расстояние до объекта с использованием триангуляции. Преимуществами стереозрения являются отсутствие активного излучения и возможность работы в широком диапазоне расстояний, однако точность метода снижается с увеличением расстояния и зависит от качества калибровки камер и алгоритмов поиска соответствий.
Другим пассивным методом является монокулярная оценка глубины, основанная на анализе размера объекта, его положения относительно горизонта или других визуальных признаков. Данный подход требует предварительных знаний о размерах объекта или использования методов машинного обучения для оценки глубины на основе контекстной информации. В контексте детектирования БПЛА монокулярная оценка глубины может быть использована при наличии информации о типе и размерах беспилотного аппарата, однако точность такой оценки ограничена и подвержена влиянию множества факторов.
Активные методы измерения расстояния основаны на излучении сигналов и анализе их отражения от объектов. Лидарные (LiDAR) системы используют лазерное излучение для формирования трехмерного облака точек, представляющего геометрию сцены. Современные лидары обеспечивают высокую точность измерения расстояния и создания трехмерных моделей окружающей среды, однако имеют ограничения при работе с удаленными или быстродвижущимися объектами, такими как БПЛА. Кроме того, лидарные системы часто имеют высокую стоимость и значительное энергопотребление, что ограничивает их применение в мобильных системах мониторинга.
Радарные системы используют радиочастотное излучение для обнаружения объектов и измерения расстояния до них на основе времени прохождения сигнала или доплеровского сдвига частоты. Преимуществами радаров являются возможность работы в любых погодных условиях и в условиях плохой видимости, а также способность обнаруживать объекты на больших расстояниях. Однако, пространственное разрешение радарных систем часто недостаточно для точной локализации малоразмерных объектов, таких как БПЛА.
Времяпролетные (Time-of-Flight, ToF) камеры измеряют время, за которое световой импульс проходит от источника до объекта и обратно к сенсору, для каждого пикселя изображения. Данная технология обеспечивает получение карты глубины с высоким разрешением и частотой кадров, что делает ее перспективной для задач трехмерного детектирования и отслеживания объектов. Современные ToF камеры имеют ограниченный диапазон действия (обычно до 10-20 метров), что может быть недостаточно для систем мониторинга БПЛА, однако развитие данной технологии продолжается, и ожидается увеличение дальности действия и точности измерений.
Системы структурированного света проецируют известный узор на сцену и анализируют его деформацию для восстановления трехмерной геометрии. Данный подход обеспечивает высокую точность на коротких расстояниях, но имеет существенные ограничения при работе на открытом пространстве и при ярком освещении, что делает его малоприменимым для задач мониторинга БПЛА.
Для систем визуального детектирования и мониторинга БПЛА наиболее перспективными представляются гибридные подходы, комбинирующие преимущества различных технологий. Например, интеграция стереозрения с радарными или лидарными системами позволяет компенсировать недостатки отдельных технологий и обеспечить более надежное и точное определение пространственного положения БПЛА в различных условиях наблюдения.
Алгоритмы трекинга объектов
Отслеживание обнаруженных БПЛА в последовательности видеокадров представляет собой важную задачу для систем мониторинга, требующую применения специализированных алгоритмов трекинга объектов. Эти алгоритмы можно классифицировать по различным критериям, включая принцип работы, используемые признаки и степень интеграции с алгоритмами детектирования.
Традиционные методы трекинга, такие как фильтр Калмана и его модификации, основаны на моделировании движения объекта и прогнозировании его будущего положения на основе предыдущих наблюдений. Фильтр Калмана представляет собой рекурсивный алгоритм, который использует серию зашумленных измерений для оценки неизвестных переменных с более высокой точностью, чем это возможно при использовании отдельных измерений. В контексте трекинга БПЛА фильтр Калмана позволяет прогнозировать траекторию движения беспилотного аппарата даже при наличии временных окклюзий или пропусков в обнаружении.
Алгоритм SORT (Simple Online and Realtime Tracking) представляет собой эффективный подход к трекингу множественных объектов, который комбинирует фильтр Калмана для предсказания траекторий и венгерский алгоритм для ассоциации данных между обнаружениями и существующими треками. SORT работает следующим образом: при обнаружении нового объекта инициализируется новый трек с соответствующей ограничивающей рамкой и уникальным идентификатором; фильтр Калмана предсказывает потенциальное положение каждого отслеживаемого объекта в следующем кадре; венгерский алгоритм сопоставляет обнаружения с предсказанными положениями на основе матрицы стоимости, обычно рассчитываемой с использованием метрики IoU (Intersection over Union); сопоставленные треки обновляются новыми данными обнаружения, а несопоставленные треки сохраняются на протяжении предопределенного числа кадров для обработки временных окклюзий.
Алгоритм DeepSORT представляет собой усовершенствованную версию SORT, которая включает глубокую нейронную сеть для извлечения визуальных признаков объектов, что позволяет более надежно сопоставлять обнаружения с существующими треками даже после длительных окклюзий или при существенных изменениях внешнего вида объекта. Данный подход особенно эффективен в сценариях с множественными подобными объектами, где метрика IoU может быть недостаточно информативной для корректной ассоциации данных. DeepSORT использует комбинацию метрик расстояния на основе визуальных признаков и пространственного положения для формирования матрицы стоимости, что обеспечивает более надежное отслеживание объектов в сложных сценариях.
ByteTrack представляет собой современный алгоритм трекинга, который отличается от предыдущих подходов тем, что использует все обнаружения, включая те, которые имеют низкую уверенность детектирования. Данный подход основан на наблюдении, что даже обнаружения с низкой уверенностью могут содержать полезную информацию для трекинга, особенно в сложных условиях, таких как частичные окклюзии или низкая освещенность. ByteTrack использует двухэтапную стратегию ассоциации: сначала высокодостоверные обнаружения ассоциируются с существующими треками на основе IoU, а затем оставшиеся треки ассоциируются с низкодостоверными обнаружениями, что позволяет сохранить непрерывность трекинга даже в сложных условиях.
Сравнительные исследования алгоритмов трекинга для задачи мониторинга БПЛА показывают, что интеграция SORT и его модификаций с детекторами на основе YOLOv8 обеспечивает значительное снижение частоты переключения идентификаторов и фрагментации обнаружения объектов между кадрами, что приводит к более надежному и непрерывному отслеживанию БПЛА. В частности, применение SORT в сочетании с фильтром Калмана и венгерским алгоритмом позволяет обеспечить плавную оценку траекторий и непрерывное отслеживание БПЛА, значительно снижая количество ошибок и повышая надежность мониторинга.
Для систем визуального детектирования и мониторинга БПЛА особую важность представляют алгоритмы трекинга, способные эффективно работать в режиме реального времени с малоразмерными быстродвижущимися объектами при наличии сложного фона и переменных условий освещения. В этом контексте алгоритмы SORT и его модификации, такие как DeepSORT и ByteTrack, представляют собой наиболее перспективные подходы благодаря их способности обеспечивать компромисс между точностью трекинга и вычислительной эффективностью.
Существующие системы мониторинга БПЛА
Разработка и внедрение систем мониторинга БПЛА представляет собой активно развивающуюся область, в которой существует множество подходов, различающихся по принципу действия, используемым технологиям и сфере применения. Современные системы мониторинга БПЛА можно классифицировать на несколько основных категорий в зависимости от используемых сенсоров и методов обработки данных.
Радиочастотные системы мониторинга основаны на обнаружении и анализе сигналов, излучаемых БПЛА и их пультами управления. Данные системы включают в себя пассивные радиочастотные сканеры, которые обнаруживают характерные сигналы, используемые для управления беспилотными аппаратами, и активные радиолокационные системы, которые обнаруживают БПЛА на основе отраженных радиосигналов. Преимуществами радиочастотных систем являются их способность обнаруживать БПЛА на больших расстояниях и возможность работы в условиях ограниченной видимости, однако они имеют ограничения при обнаружении автономных БПЛА, не использующих радиоканал для управления, или малоразмерных БПЛА с низкой эффективной поверхностью рассеяния.
Акустические системы мониторинга используют массивы микрофонов для обнаружения и локализации БПЛА на основе звуковых сигналов, издаваемых их двигателями и пропеллерами. Данные системы особенно эффективны на коротких и средних дистанциях и могут обнаруживать БПЛА любого типа, включая автономные аппараты, не использующие радиосвязь. Однако, акустические системы имеют существенные ограничения при работе в условиях высокого уровня фонового шума и подвержены влиянию ветра и других атмосферных факторов.
Оптические системы мониторинга, основанные на визуальном детектировании БПЛА с использованием камер видимого или инфракрасного диапазона, представляют собой активно развивающееся направление. Данные системы используют алгоритмы компьютерного зрения и машинного обучения для обнаружения, классификации и отслеживания БПЛА на изображениях и видеопотоке. Преимуществами оптических систем являются высокая точность идентификации типа БПЛА и возможность работы с автономными аппаратами, однако они имеют ограничения при работе в условиях плохой видимости, таких как туман, дождь или низкая освещенность.
Гибридные системы мониторинга комбинируют различные типы сенсоров для повышения надежности и эффективности обнаружения БПЛА. Например, интеграция радиочастотных, акустических и оптических сенсоров позволяет компенсировать недостатки отдельных технологий и обеспечить надежное обнаружение и отслеживание БПЛА в различных условиях эксплуатации. Гибридные системы часто используют методы многоканальной обработки данных и алгоритмы слияния информации для повышения точности и надежности мониторинга.
Коммерческие системы мониторинга БПЛА, такие как DeDrone, AeroScope и DroneShield, предлагают комплексные решения для обнаружения, идентификации и противодействия несанкционированным БПЛА. Данные системы часто включают в себя множество компонентов, включая радиочастотные сканеры, акустические сенсоры, камеры и централизованные платформы управления, обеспечивающие интеграцию и визуализацию данных от различных источников. Некоторые из этих систем также включают компоненты для нейтрализации обнаруженных БПЛА, такие как радиочастотные глушители или системы физического перехвата.
Академические и исследовательские проекты в области мониторинга БПЛА часто фокусируются на разработке новых алгоритмов и методов обнаружения, классификации и отслеживания, а также на интеграции этих методов в комплексные системы мониторинга. Например, проект UAV Detection Using Convolutional Neural Networks, описанный в работе Taha и Shoufan, направлен на исследование эффективности различных архитектур CNN для детектирования БПЛА в видеопотоке и сравнение их производительности с традиционными методами компьютерного зрения.
Выводы по главе
Анализ существующих методов и технологий в области визуального детектирования и мониторинга БПЛА позволяет сделать ряд важных выводов. Современные методы визуального детектирования БПЛА эволюционировали от традиционных подходов, основанных на выделении характерных признаков изображения, к методам глубокого обучения, в частности, сверточным нейронным сетям, которые демонстрируют значительно более высокую точность и надежность обнаружения малоразмерных быстродвижущихся объектов в различных условиях наблюдения.
Среди современных архитектур нейронных сетей для детектирования объектов наиболее перспективными для задачи обнаружения БПЛА являются одноэтапные детекторы, такие как YOLO и SSD, которые обеспечивают оптимальный баланс между точностью и скоростью обработки, что критически важно для систем реального времени. В частности, последние версии YOLO, особенно YOLOv8, демонстрируют значительные улучшения в точности обнаружения малоразмерных объектов при сохранении высокой скорости обработки.
Технологии измерения расстояния до объектов представлены широким спектром методов, включая стереозрение, лидарные и радарные системы, времяпролетные камеры и системы структурированного света. Для систем мониторинга БПЛА наиболее перспективными представляются гибридные подходы, комбинирующие преимущества различных технологий для обеспечения надежного и точного определения пространственного положения БПЛА в различных условиях наблюдения.
Алгоритмы трекинга объектов, такие как SORT, DeepSORT и ByteTrack, обеспечивают непрерывное отслеживание обнаруженных БПЛА даже в условиях временных окклюзий или нестабильного детектирования. Интеграция этих алгоритмов с детекторами на основе YOLOv8 позволяет создавать эффективные системы мониторинга, способные надежно отслеживать траектории движения БПЛА в режиме реального времени.
Существующие системы мониторинга БПЛА представлены различными подходами, включая радиочастотные, акустические, оптические и гибридные системы, каждая из которых имеет свои преимущества и ограничения. Наиболее эффективными представляются гибридные системы, комбинирующие различные типы сенсоров и методы обработки данных для повышения надежности и эффективности обнаружения и отслеживания БПЛА в различных условиях эксплуатации.
Проведенный обзор существующих методов и технологий позволяет определить наиболее перспективные направления для разработки эффективной системы визуального детектирования и мониторинга БПЛА. Оптимальным подходом представляется интеграция современных архитектур нейронных сетей для детектирования объектов, таких как YOLOv8, с алгоритмами трекинга, такими как SORT или его модификации, и дополнительными технологиями измерения расстояния, такими как стереозрение или времяпролетные камеры. Данный подход позволит создать комплексную систему, способную эффективно обнаруживать, классифицировать и отслеживать БПЛА в различных условиях наблюдения с высокой точностью и надежностью.
Глава 2. Теоретические основы детектирования объектов
Методы машинного обучения для детектирования объектов
Детектирование объектов представляет собой одну из фундаментальных задач в области компьютерного зрения и обработки изображений. Современные методы детектирования объектов базируются на различных подходах машинного обучения, которые эволюционировали от классических алгоритмов до сложных нейросетевых архитектур. Исторически первыми стали применяться классические методы, основанные на выделении характерных признаков изображений.
Метод базового понимания использует особые признаки для поиска объектов, фокусируясь на алгоритме выделения границ объектов на изображении. Данный метод применяет фильтры и математические операции для определения особых характеристик объектов, таких как форма и цвет. Другим распространенным подходом является метод скользящего окна, который основан на перемещении прямоугольной области разного размера по изображению с последующим применением обученной модели для определения наличия объекта в каждом положении окна.
Метод облачных точек представляет собой подход, в котором объекты интерпретируются как группы точек, образующих характерные облачные скопления. Анализ геометрических характеристик этих облачных точек, включая их размер, форму и положение на изображении, позволяет эффективно выявлять потенциальные объекты без применения сложных вычислений. Данный метод отличается простотой и интуитивной понятностью, хотя имеет ограничения при работе с объектами сложной формы или в условиях переменного освещения.
Метод каскадных классификаторов представляет собой уникальный подход, основанный на последовательном использовании фильтров и классификаторов различной сложности. Его преимущество заключается в способности быстро отбрасывать области изображения, не содержащие интересующие объекты, концентрируя вычислительные ресурсы на потенциально значимых областях. Этот метод находит применение в задачах, требующих эффективного анализа изображений при ограниченных вычислительных ресурсах.
С развитием вычислительных мощностей и появлением больших наборов данных произошел переход к методам, основанным на глубоком обучении, которые показали значительно лучшие результаты в задачах детектирования объектов. Нейронные сети различных архитектур стали основным инструментом для решения задач обнаружения и распознавания объектов, демонстрируя превосходные показатели точности и скорости работы по сравнению с классическими методами.
Сверточные нейронные сети в задачах детектирования
Сверточные нейронные сети (CNN) представляют собой особый класс глубоких нейронных сетей, которые продемонстрировали исключительную эффективность в задачах компьютерного зрения, включая детектирование объектов. Основное преимущество CNN заключается в их способности автоматически извлекать иерархию признаков из изображений, начиная от простых краев и текстур до сложных структур и форм объектов.
Детектирование объектов с использованием CNN включает три основных задачи: классификацию, локализацию и сегментацию. На этапе классификации сеть анализирует изображение для идентификации присутствующих на нем объектов, определяя их принадлежность к заранее установленным классам. Например, сеть может распознать на изображении присутствие автомобилей, пешеходов или других объектов на основе извлеченных признаков.
На этапе локализации CNN определяет точное положение обнаруженных объектов, предсказывая ограничивающие рамки (bounding boxes) вокруг них. Эти рамки представляют собой прямоугольные области, содержащие идентифицированные объекты, и задаются координатами их вершин. Точность локализации объектов является критически важным аспектом для многих практических приложений, включая системы мониторинга и автономные транспортные средства.
Сегментация представляет собой более сложную задачу, при которой сеть не только обнаруживает и локализует объекты, но также определяет их точные границы на пиксельном уровне, отделяя объекты от фона и друг от друга. Этот подход обеспечивает наиболее детальное понимание сцены, но требует значительных вычислительных ресурсов.
Процесс обучения CNN для задач детектирования объектов основан на методе обратного распространения ошибки, который позволяет корректировать веса сети для минимизации расхождения между предсказанными и истинными значениями. Этот механизм позволяет сетям адаптироваться к изменениям в размере, угле обзора или освещении объектов, обеспечивая устойчивость к различным условиям съемки.
Важной особенностью CNN является их способность к трансферному обучению, когда предварительно обученная на больших наборах данных сеть может быть дообучена для решения специфических задач с использованием значительно меньшего объема данных. Этот подход особенно ценен при разработке систем детектирования для специализированных областей, включая обнаружение БПЛА.
Архитектуры современных детекторов 
Современные архитектуры детекторов объектов можно разделить на две основные категории: двухэтапные (two-stage) и одноэтапные (one-stage) детекторы. Наибольшее распространение в последние годы получили архитектуры Faster R-CNN, YOLO и SSD, каждая из которых имеет свои преимущества и особенности реализации.
Faster R-CNN (Region-based Convolutional Neural Network) представляет собой двухэтапный детектор, который усовершенствовал процесс генерации предложений регионов (region proposals) путем введения сети предложения регионов (Region Proposal Network, RPN). На первом этапе изображение обрабатывается через CNN для получения карт признаков высокого уровня. Затем RPN применяет подход скользящего окна к этим картам признаков, используя якорные боксы (anchor boxes) различных размеров в каждой позиции окна. Для каждого якорного бокса RPN предсказывает вероятность наличия объекта и значения регрессии для уточнения позиции бокса. На втором этапе предложенные регионы классифицируются и уточняются через полносвязный слой, что дает финальные предсказания классов объектов и точно настроенные ограничивающие рамки. Faster R-CNN обеспечивает высокую точность обнаружения, однако его вычислительная сложность и относительно низкая скорость обработки изображений являются существенными ограничениями для применений в реальном времени.
YOLO (You Only Look Once) представляет собой одноэтапный детектор, разработанный с целью повышения скорости обработки изображений при сохранении приемлемой точности. YOLO обрабатывает изображение за один проход через нейронную сеть, предсказывая одновременно положения объектов и их классы. Архитектура YOLO преобразует задачу детектирования объектов в регрессионную задачу от конца до конца, разделяя изображение на сетку и предсказывая для каждой ячейки сетки ограничивающие рамки, вероятности принадлежности объекта к классам и значения достоверности. Такой подход значительно увеличивает скорость обработки, позволяя достигать показателей от 40 до 155 кадров в секунду в зависимости от конфигурации, что делает YOLO предпочтительным выбором для систем реального времени. Последние версии YOLO, включая YOLOv8, демонстрируют улучшенную производительность по метрике средней точности (mAP) при сниженных вычислительных затратах.
SSD (Single Shot Detector) также является одноэтапным детектором, который обрабатывает изображение за один проход, но в отличие от YOLO использует многомасштабный подход для обнаружения объектов разных размеров. SSD применяет глубокую нейронную сеть для дискретизации выходного пространства ограничивающих рамок на набор боксов по умолчанию с различными соотношениями сторон и масштабами для каждой позиции карты признаков. Сеть генерирует оценки для наличия каждой категории объектов в каждом боксе по умолчанию и корректирует бокс для лучшего соответствия форме объекта. SSD сочетает предсказания из карт признаков с разными разрешениями для эффективной обработки объектов различных размеров, обеспечивая скорость от 22 до 46 кадров в секунду при сохранении хорошей точности. SSD занимает промежуточное положение между YOLO и Faster R-CNN, предлагая баланс между скоростью и точностью, что делает его универсальным выбором для различных приложений.
Сравнительные исследования показывают, что сети Faster R-CNN демонстрируют превосходство в точности, особенно при использовании в качестве базовой сети InceptionResnet-2, однако требуют значительного времени на обработку изображения. Архитектуры SSD, особенно в сочетании с сетями MobileNet, являются наиболее подходящими для обработки изображений в режиме реального времени, обеспечивая компромисс между скоростью и точностью. YOLO предлагает наилучшее соотношение скорости и точности, что делает его популярным выбором для систем, где критично время обработки.
Метрики оценки качества детектирования
Оценка эффективности моделей детектирования объектов требует применения специализированных метрик, которые позволяют количественно характеризовать различные аспекты работы детектора. Ключевыми метриками, используемыми при оценке качества детектирования, являются IoU, Precision, Recall, Average Precision и F1 Score.
Пересечение над объединением (Intersection over Union, IoU) является фундаментальной метрикой, которая количественно определяет перекрытие между предсказанной ограничивающей рамкой и истинной ограничивающей рамкой (ground truth box). IoU рассчитывается как отношение площади пересечения двух рамок к площади их объединения, и его значение варьируется от 0 до 1, где 1 означает идеальное совпадение. Данная метрика играет ключевую роль в оценке точности локализации объектов и часто используется в качестве порогового значения для определения, считается ли обнаружение истинно положительным.
Точность (Precision) и полнота (Recall) являются основополагающими метриками, характеризующими два различных аспекта эффективности детектора. Точность определяется как отношение числа истинно положительных обнаружений к общему числу положительных предсказаний модели (сумме истинно положительных и ложно положительных). Эта метрика оценивает способность модели избегать ложных срабатываний. Полнота рассчитывается как отношение числа истинно положительных обнаружений к общему числу положительных образцов в исходном наборе данных (сумме истинно положительных и ложно отрицательных). Полнота оценивает способность модели обнаруживать все экземпляры интересующего класса.
Средняя точность (Average Precision, AP) представляет собой интегральную характеристику, рассчитываемую как площадь под кривой "точность-полнота" (precision-recall curve). AP вычисляется отдельно для каждого класса и предоставляет единое значение, отражающее баланс между точностью и полнотой модели при различных порогах достоверности. Средняя точность по всем классам (Mean Average Precision, mAP) расширяет концепцию AP, вычисляя среднее значение AP для нескольких классов объектов. mAP является одной из наиболее распространенных метрик для комплексной оценки производительности моделей детектирования в задачах с множеством классов.
F1 Score представляет собой среднее гармоническое значений точности и полноты, рассчитываемое по формуле 2*(точность*полнота)/(точность+полнота). Эта метрика обеспечивает сбалансированную оценку эффективности модели, учитывая как ложноположительные, так и ложноотрицательные результаты. F1 Score особенно полезен в ситуациях, когда необходимо найти оптимальный баланс между точностью и полнотой.
Выбор определенных метрик для оценки качества детектирования зависит от конкретного приложения и его требований. Например, mAP подходит для широкой оценки эффективности модели, IoU незаменим, когда важно точное определение местоположения объекта, точность важна при необходимости минимизации ложных обнаружений, а полнота критична, когда требуется обнаружить каждый экземпляр объекта. Для приложений, работающих в режиме реального времени, также важными являются метрики скорости, такие как количество кадров в секунду (FPS) и задержка, которые обеспечивают своевременность результатов.
Выводы по главе
В результате проведенного анализа теоретических основ детектирования объектов можно сделать следующие выводы. Методы детектирования объектов эволюционировали от классических подходов, основанных на выделении характерных признаков изображений, к современным нейросетевым архитектурам, обеспечивающим значительно более высокую точность и скорость обработки. Сверточные нейронные сети стали ключевым инструментом для решения задач обнаружения и распознавания объектов благодаря их способности автоматически извлекать иерархические признаки из изображений.
Современные архитектуры детекторов объектов, включая Faster R-CNN, YOLO и SSD, представляют собой различные подходы к балансированию между точностью и скоростью обработки. Двухэтапные детекторы, такие как Faster R-CNN, обеспечивают высокую точность, но имеют относительно низкую скорость обработки. Одноэтапные детекторы, включая YOLO и SSD, предлагают компромисс между скоростью и точностью, причем YOLO демонстрирует наилучшее соотношение этих параметров для систем реального времени.
Оценка эффективности моделей детектирования объектов требует применения специализированных метрик, включая IoU, Precision, Recall, Average Precision и F1 Score, каждая из которых характеризует различные аспекты работы детектора. Выбор конкретных метрик для оценки качества детектирования зависит от требований конкретного приложения.
В контексте разработки средств визуального детектирования и мониторинга БПЛА наиболее перспективными представляются одноэтапные детекторы, такие как YOLO и SSD, которые обеспечивают необходимый баланс между точностью и скоростью обработки для задач реального времени. Последние версии YOLO, в частности YOLOv8, демонстрируют улучшенную производительность при сниженных вычислительных затратах, что делает их предпочтительным выбором для систем детектирования БПЛА. Однако в зависимости от конкретных требований к системе мониторинга, включая требуемую точность и доступные вычислительные ресурсы, могут быть рассмотрены и другие архитектуры.
Глава 3. Теоретические основы стереозрения
Калибровка камеры
Калибровка камеры – это процесс определения внутренних (интринзических) и внешних (экстринзических) параметров камеры, а также коэффициентов искажений, вызванных оптическими дефектами. Полученные параметры позволяют построить модель, которая переводит координаты 3D-объектов в 2D-координаты изображения с учётом искажений оптики. Данная процедура является ключевой для задач компьютерного зрения, таких как стереозрение, 3D-реконструкция и робототехника.
В данном разделе описываются математические основы калибровки камеры, а также практическая реализация процесса с использованием изображений шахматной доски.
Базовая модель, лежащая в основе большинства алгоритмов калибровки, – это пинхол (игольчатая) модель камеры. В ней проекция 3D-точки (X, Y, Z) в 2D-точку (u, v) описывается следующим соотношением:
s[█(u@v@1)]= K[├ R┤|t][█(X@Y@Z@1)]
где:
	s – масштабирующий коэффициент;
	K – внутренняя матрица камеры;
	R – матрица поворота (3x3);
	t – вектор переноса (3x1).
Внутренняя матрица K задаётся как:
K=[■(f_x&0&c_x@0&f_y&c_y@0&0&1)]
где f_x и f_y – фокусные расстояния в пикселях по горизонтали и вертикали, а c_x иc_y – координаты главной точки (оптический центр).
Экстинзические параметры R и t задают положение и ориентацию камеры в мировом пространстве. Эти параметры позволяют выполнить преобразование из координат системы мира в систему координат камеры и далее произвести проекцию на изображение.
При моделировании реальных камер необходимо учитывать оптические искажения, которые вносят отклонения от идеальной пинхол-модели. Основные типы искажений:
	 Учёт оптических искажений
При реальной эксплуатации камеры изображение подвержено оптическим искажениям, которые корректируются следующими параметрами:
	Радиальное искажение – исправляет «раздувание» или «сжатие» изображения от центра.
	Тангенциальное искажение – компенсирует смещения, вызванные несовершенным совмещением оптической оси и матрицы светочувствительного элемента.
Эта модель искажений применяется для устранения ошибок проекции, что критично при последующих вычислениях расстояния.
	Процесс калибровки
Для калибровки камеры используется набор изображений калибровочной таблицы (например, шахматной доски). Общая процедура включает следующие этапы:
	Подготовка данных:
	Задание параметров шахматной доски (размер внутренней сетки, размер квадрата).
	Формирование набора 3D-координат (объектные точки), соответствующих узлам доски.
	Поиск изображений:
Изображения считываются из указанной папки (например, с расширениями .jpg и .png).
	Обработка изображений:
	Преобразование изображения в оттенки серого.
	Поиск углов шахматной доски с использованием cv2.findChessboardCorners.
	Уточнение положения углов до субпиксельной точности (cv2.cornerSubPix).
	Сохранение пар «объектных точек – точек изображения».
	Минимизация ошибки репроекции:
Использование функции cv2.calibrateCamera для оптимизации параметров. Результатом являются внутренняя матрица K, коэффициенты искажений, а также экстинзические параметры.
	Сохранение результатов:
Параметры калибровки сохраняются в виде файла (например, формата npz) для дальнейшего использования в коррекции входных изображений.
 
Расчёт расстояния до объекта
Перед проведением процедуры калибровки необходимо описать принцип расчёта расстояния до объекта с использованием стереоскопической системы:
	Архитектура стереосистемы:
Используется пара видеокамер, размещённых на известном расстоянии друг от друга (базис, T). Оптические оси камер расположены параллельно, что позволяет впоследствии выполнить ректификацию изображений. Такая конфигурация гарантирует, что соответствующие точки на левом и правом изображениях будут лежать на одной горизонтальной линии.
	Выделение соответствий.
При получении изображений с двух камер для каждой точки на изображении левой камеры осуществляется поиск соответствующей точки на изображении правой камеры. Разница между координатами этих точек по горизонтали называется disparity (d):
d=x_left-x_right
Где x_left и x_right  — это горизонтальные координаты одних и тех же точек сцены, проецируемой на изображения левой и правой камер соответственно
При этом обработка изображений включает предварительную коррекцию оптических искажений и ректификацию для упрощения поиска соответствий.
	Триангуляция и вычисление глубины.
Зная фокусное расстояние f (выраженное в пикселях), базис T и найденное смещение d, глубина Z (расстояние до объекта) вычисляется по формуле:
Z=(f⋅T)/d
Таким образом, глубина обратно пропорциональна величине смещения: небольшие значения dприводят к высоким значениям Z, а при больших d объекты расположены ближе к камере. Для построения карты глубины часто применяются алгоритмы поиска корреспонденций, такие как StereoBM или более точный StereoSGBM, а также функция OpenCV reprojectImageTo3D, преобразующая disparity в трёхмерные координаты.
Данный процесс позволяет в режиме реального времени получать информацию о расстоянии до объектов, что является критически важным для навигации и безопасности движущихся роботизированных устройств.
 
Пошаговый алгоритм вычисления расстояния
	 Предобработка изображений
	Синхронизация размеров:
  Изображения с левой и правой камер приводятся к одинаковым размерам, что необходимо для корректного сопоставления.
	Преобразование в оттенки серого:
  Для упрощения вычислений изображения конвертируются в grayscale.
	Коррекция искажений:
  С использованием сохранённых параметров калибровки применяется функция cv2.undistort, которая устраняет оптические искажения. В результате получаются «ректифицированные» изображения, на которых выполнена пространственная коррекция.
	 Вычисление карты диспарантности
	С использованием алгоритма StereoSGBM, настроенного с оптимальными параметрами, для пары корректированных изображений вычисляется карта диспарантности. Этот алгоритм сопоставляет соответствующие области в левом и правом изображениях и определяет величину смещения (disparity) для каждого пикселя.
	Полученная карта подвергается фильтрации (например, с помощью медианного фильтра cv2.medianBlur) для исключения шумов и получения более стабильных значений disparity.
	 Определение зоны интереса (ROI)
При обнаружении объекта с помощью YOLO (и последующего трекинга с помощью алгоритма SORT) для каждого объекта определяется ограничивающий прямоугольник (bounding box).
	Из карты диспарантности выделяется область, соответствующая bounding box объекта.
	Из выбранной области собираются корректные (ненулевые) значения диспарантности, которые усредняются для получения среднего значения, характеризующего смещение объекта.
	 Вычисление фактического расстояния
Используя ранее полученное среднее значение диспарантности (avg_disp), фокусное расстояние f (вычисленное как среднее из значений двух камер) и известное расстояние baseline, рассчитывается расстояние до объекта по формуле:
z=,(f⋅T)/(avg_disp+ε)
где ε – малая величина (например, 10^(-6)), предотвращающая деление на ноль.
	 Вывод результатов
	Расчитанное расстояние отображается поверх изображения (например, вместе с идентификатором объекта), позволяя визуально оценить положение объекта в пространстве.
	Полученные данные могут использоваться для последующего анализа, построения карты глубин или интегрироваться в систему навигации.
	 Интеграция в систему обнаружения объектов
Класс ObjectDetection в представленном коде объединяет этапы обнаружения и трекинга объектов (на базе YOLO и SORT) с алгоритмом вычисления расстояния. Для каждого обнаруженного объекта:
	Вычисляется bounding box.
	По заданной области из bounding box вызывается функция вычисления расстояния.
	На изображении выводятся рамки, идентификаторы объектов и расстояния до них.
Синхронизация камер
Одним из критически важных условий для корректного применения метода стереозрения является синхронное получение изображений обеими камерами. В установке для синхронизации используется метод вспышки. Это позволяет:
	Обеспечить одновременный захват: Срабатывание вспышки инициирует одновременное получение изображений обеими камерами.
	Устранить временные смещения: Отсутствие разницы во времени между кадрами гарантирует, что сцена на левых и правых изображениях будет идентичной, что критично при поиске соответствий.
	Повысить точность расчётов: Корректное сопоставление точек между изображениями позволяет снизить погрешности при вычислении диспаратности и, соответственно, расстояния до объекта.
Выводы по главе
В третьей главе рассмотрены теоретические основы стереозрения, включая калибровку камер, учет оптических искажений и расчет расстояния до объектов. Калибровка камеры позволяет определить её внутренние и внешние параметры, а также скорректировать радиальные и тангенциальные искажения, что критически важно для точных вычислений. Основой калибровки является пинхол-модель, описывающая проекцию 3D-точек на 2D-плоскость изображения.
Стереосистемы, состоящие из двух камер, позволяют определять глубину сцены за счет анализа диспарантности — разницы в координатах соответствующих точек на изображениях. Расчет глубины осуществляется с использованием параметров камеры (фокусное расстояние, базис) и смещения точек. Для построения карты глубины применяются алгоритмы StereoBM или StereoSGBM.
Практическая реализация включает предобработку изображений, вычисление карты диспарантности и определение расстояния до объектов. Интеграция методов стереозрения с системами обнаружения объектов (например, YOLO) позволяет определять положение объектов в пространстве и использовать эти данные для мониторинга или навигации. Глава демонстрирует значимость алгоритмической обработки данных для решения задач визуального детектирования и мониторинга беспилотных летательных аппаратов.
